<!DOCTYPE html>
<html lang="es">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Estadísticas de Contactos</title>
		<link rel="stylesheet" href="/estilos/style.css" />
	</head>
	<body>
		<header class="site-header"><%- include('partials/navbar') %></header>

		<main class="container">
			<h1>Estadísticas de Contactos</h1>

			<!-- Resumen general -->
			<div class="stats-grid">
				<% const totalContacto = contactosPorBarrio.reduce((sum, barrio) => sum + barrio.cantidad, 0); %> 
				<% const totalBarrios = contactosPorBarrio.length;%> 
				<% const promedioPorBarrio = totalContacto / totalBarrios; %>
				<div class="stat-card">
					<div class="stat-icon">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							width="32"
							height="32"
							viewBox="0 0 24 24"
							fill="none"
							stroke="currentColor"
							stroke-width="2"
							stroke-linecap="round"
							stroke-linejoin="round"
						>
							<path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
							<circle cx="9" cy="7" r="4"></circle>
							<path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
							<path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
						</svg>
					</div>
					<div class="stat-content">
						<h3 id="total_contactos"><%= totalContacto %></h3>
						<p>Total Contactos</p>
					</div>
				</div>
				<div class="stat-card">
					<div class="stat-icon">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							width="32"
							height="32"
							viewBox="0 0 24 24"
							fill="none"
							stroke="currentColor"
							stroke-width="2"
							stroke-linecap="round"
							stroke-linejoin="round"
						>
							<path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
							<circle cx="12" cy="10" r="3"></circle>
						</svg>
					</div>
					<div class="stat-content">
						<h3 id="total_barrios"><%= totalBarrios %></h3>
						<p>Barrios Diferentes</p>
					</div>
				</div>

				<div class="stat-card">
					<div class="stat-icon">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							width="32"
							height="32"
							viewBox="0 0 24 24"
							fill="none"
							stroke="currentColor"
							stroke-width="2"
							stroke-linecap="round"
							stroke-linejoin="round"
						>
							<path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
							<circle cx="8.5" cy="7" r="4"></circle>
							<line x1="23" y1="11" x2="17" y2="11"></line>
						</svg>
					</div>
					<div class="stat-content">
						<h3 id="promedio_por_barrio"><%= promedioPorBarrio.toFixed(1) %></h3>
						<p>Promedio por Barrio</p>
					</div>
				</div>
			</div>

			<!-- Distribución por barrio -->
			<div class="stats-section">
				<h2>
					<svg
						xmlns="http://www.w3.org/2000/svg"
						width="24"
						height="24"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="2"
						stroke-linecap="round"
						stroke-linejoin="round"
						style="vertical-align: middle; margin-right: 0.5rem"
					>
						<line x1="18" y1="20" x2="18" y2="10"></line>
						<line x1="12" y1="20" x2="12" y2="4"></line>
						<line x1="6" y1="20" x2="6" y2="14"></line>
					</svg>
					Distribución de Contactos por Barrio
				</h2>

				<div id="barrios_container" class="progress-list">
					<!-- Aquí se cargarán dinámicamente las barras de progreso -->
					<% barriosOrdenados = contactosPorBarrio.sort((a, b) => b.cantidad - a.cantidad); %>
					<% const colores = [
						"linear-gradient(135deg, #4a9eff 0%, #2c7fd9 100%)",
						"linear-gradient(135deg, #10b981 0%, #059669 100%)",
						"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)",
						"linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)",
						"linear-gradient(135deg, #ec4899 0%, #db2777 100%)",
						"linear-gradient(135deg, #06b6d4 0%, #0891b2 100%)",
						"linear-gradient(135deg, #ef4444 0%, #dc2626 100%)",
						"linear-gradient(135deg, #14b8a6 0%, #0d9488 100%)",
						"linear-gradient(135deg, #f97316 0%, #ea580c 100%)",
						"linear-gradient(135deg, #a855f7 0%, #9333ea 100%)",
					] %>
					
					<% barriosOrdenados.forEach((barrio, index) => { 
						const porcentaje = (barrio.cantidad / totalContacto) * 100;
						const color = colores[index % colores.length];
					%>
						<%- include('partials/barraPorcentajes', { nombre: barrio.barrio, cantidad: barrio.cantidad, porcentaje: porcentaje, color: color }) %>
					<% }); %>
				</div>
			</div>
		</main>
	</body>
	<!-- <script src="/js/estadisticas.js"></script> -->
</html>
